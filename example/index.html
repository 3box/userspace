<!doctype html>

<html>
  <head>
    <title>UserSpace demo</title>
    <script type="text/javascript" src="../dist/userspace.js"></script>
  </head>

  <body>

    <button id="bopen">Open UserSpace</button>
    <br />
    <div id="controlls" style="display: none">
      <input type="text" id="skey" placeholder="Key">
      <input type="text" id="svalue" placeholder="Value">
      <button id="setItem">Set</button>
      <br />
      <input type="text" id="gkey" placeholder="Key">
      <input type="text" id="gvalue" placeholder="Value" disabled>
      <button id="getItem">Get</button>
      <br />
      <input type="text" id="rkey" placeholder="Key">
      <button id="removeItem">Remove</button>
      <br />
      <button id="showAll">Show all data in the hub</button>
      <br>
    </div>
    <span id="hubdata"></span>


  </body>

  <script type="text/javascript">
    bopen.addEventListener('click', event => {
      UserSpace.open(web3.eth.accounts[0]).then(userspace => {
        controlls.style.display = 'inline'
        window.userspace = userspace
        setItem.addEventListener('click', () => {
          userspace.set(skey.value, svalue.value).then(() => {
            skey.value = null
            svalue.value = null
          })
        })
        getItem.addEventListener('click', () => {
          userspace.get(gkey.value).then(value => {
            gvalue.value = value
          })
        })
        removeItem.addEventListener('click', () => {
          userspace.remove(rkey.value).then(() => {
            rkey.value = null
          })
        })
        showAll.addEventListener('click', () => {
          // TODO
          userspace.getAll().then(items => {
            hubdata.innerHTML = ''
            Object.entries(items).map(item => {
              hubdata.innerHTML += item[0] + ': ' + item[1] + '<br />'
            })
          })
        })
      })
    })
  </script>

</html>
